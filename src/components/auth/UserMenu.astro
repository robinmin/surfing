---
/**
 * UserMenu Component
 * Popup menu for authenticated users with profile and sign out options
 */
import { Icon } from 'astro-icon/components';

export interface Props {
  className?: string;
}

const { className = '' } = Astro.props;
---

<div
  class:list={[
    'user-menu absolute bottom-full mb-2 right-0',
    'bg-white dark:bg-gray-800',
    'border border-gray-200 dark:border-gray-700',
    'rounded-lg shadow-lg',
    'min-w-[200px]',
    'opacity-0 invisible',
    'transition-all duration-200 ease-in-out',
    'z-50',
    className,
  ]}
  data-user-menu
>
  <div class="py-2">
    <!-- User info section -->
    <div class="px-4 py-2 border-b border-gray-200 dark:border-gray-700">
      <div class="text-sm font-medium text-gray-900 dark:text-gray-100" data-user-name>Loading...</div>
      <div class="text-xs text-gray-500 dark:text-gray-400" data-user-email>Loading...</div>
    </div>

    <!-- Sign out button -->
    <button
      type="button"
      class="user-menu-signout w-full flex items-center gap-3 px-4 py-2.5 text-left hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"
    >
      <Icon name="tabler:logout" class="h-5 w-5 text-gray-700 dark:text-gray-300" />
      <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Sign out</span>
    </button>
  </div>
</div>

<style>
  .user-menu.show {
    opacity: 1;
    visibility: visible;
  }

  /* Arrow pointing down to avatar */
  .user-menu::after {
    content: '';
    position: absolute;
    bottom: -6px;
    right: 12px;
    width: 12px;
    height: 12px;
    background: inherit;
    border-right: 1px solid;
    border-bottom: 1px solid;
    border-color: inherit;
    transform: rotate(45deg);
  }

  /* Responsive adjustments */
  @media (max-width: 640px) {
    .user-menu {
      right: 0;
      min-w: 180px;
    }
  }
</style>
