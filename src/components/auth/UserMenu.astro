---
/**
 * UserMenu Component
 * Popup menu for authenticated users with profile and sign out options
 */
import { Icon } from 'astro-icon/components';

export interface Props {
  className?: string;
}

const { className = '' } = Astro.props;
---

<div
  class:list={[
    'user-menu absolute top-full mt-2 right-0',
    'bg-white dark:bg-gray-800',
    'border border-gray-200 dark:border-gray-700',
    'rounded-lg shadow-xl',
    'min-w-[220px]',
    'opacity-0 invisible',
    'transition-all duration-200 ease-in-out',
    'z-[60]', // Higher z-index to ensure it's above everything
    className,
  ]}
  data-user-menu
>
  <div class="py-2">
    <!-- User info section -->
    <div class="px-4 py-2 border-b border-gray-200 dark:border-gray-700">
      <div class="text-sm font-medium text-gray-900 dark:text-gray-100" data-user-name>Loading...</div>
      <div class="text-xs text-gray-500 dark:text-gray-400" data-user-email>Loading...</div>
    </div>

    <!-- Sign out button -->
    <button
      type="button"
      class="user-menu-signout w-full flex items-center gap-3 px-4 py-3 text-left hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors rounded-md mx-2 my-1 border border-transparent hover:border-red-200 dark:hover:border-red-800"
    >
      <Icon name="tabler:logout" class="h-5 w-5 text-red-600 dark:text-red-400 flex-shrink-0" />
      <span class="text-sm font-medium text-red-700 dark:text-red-300">Sign out</span>
    </button>
  </div>
</div>

<style>
  .user-menu.show {
    opacity: 1;
    visibility: visible;
  }

  /* Arrow pointing up to avatar */
  .user-menu::before {
    content: '';
    position: absolute;
    top: -6px;
    right: 16px;
    width: 12px;
    height: 12px;
    background: inherit;
    border-right: 1px solid;
    border-bottom: 1px solid;
    border-color: inherit;
    transform: rotate(-45deg);
  }

  /* Responsive adjustments */
  @media (max-width: 640px) {
    .user-menu {
      right: 0;
      min-w: 180px;
    }
  }
</style>
