<!doctype html>
<html>
  <head>
    <title>Google Auth Test</title>
  </head>
  <body>
    <h1>Google Authentication Test</h1>
    <div id="test-results"></div>

    <script>
      const results = document.getElementById('test-results');

      function log(message) {
        console.log(message);
        results.innerHTML += '<p>' + message + '</p>';
      }

      // Test 1: Check if environment variables are accessible
      log('Testing environment variables...');
      fetch('/src/lib/google-auth.ts')
        .then((response) => response.text())
        .then((code) => {
          if (code.includes('PUBLIC_GOOGLE_CLIENT_ID')) {
            log('✅ PUBLIC_GOOGLE_CLIENT_ID is configured');
          } else {
            log('❌ PUBLIC_GOOGLE_CLIENT_ID not found');
          }
        })
        .catch((error) => {
          log('❌ Error loading Google auth module: ' + error.message);
        });

      // Test 2: Check if Google GSI script can be loaded
      log('Testing Google GSI script...');
      const script = document.createElement('script');
      script.src = 'https://accounts.google.com/gsi/client';
      script.onload = function () {
        log('✅ Google GSI script loaded successfully');
        if (window.google && window.google.accounts) {
          log('✅ Google Accounts API is available');
        } else {
          log('❌ Google Accounts API not available');
        }
      };
      script.onerror = function () {
        log('❌ Failed to load Google GSI script');
      };
      document.head.appendChild(script);

      // Test 3: Check authentication container on main page
      log('Testing authentication container...');
      fetch('http://localhost:4321/')
        .then((response) => response.text())
        .then((html) => {
          if (html.includes('auth-container')) {
            log('✅ Authentication container found in HTML');
          } else {
            log('❌ Authentication container not found');
          }

          if (html.includes('google-signin')) {
            log('✅ Google Sign-In container found in HTML');
          } else {
            log('❌ Google Sign-In container not found');
          }
        })
        .catch((error) => {
          log('❌ Error fetching main page: ' + error.message);
        });
    </script>
  </body>
</html>
